# Plan: Fix Admin Dashboard Users Role Filter

## Problem Analysis

### Current Behavior Issues:
1. **State not synced with URL params**: When URL changes after clicking Filter, the UserSearch component doesn't update its internal state to reflect the new URL parameters
2. The Select dropdown may show outdated values when navigating or when page re-renders with different params

### Database Status (from Supabase MCP):
- Role 0 (Admin): 1 user
- Role 1 (Moderator): 0 users  
- Role 2 (User): 295 users

### Root Cause:
In `user-search.tsx`, useState initializes from searchParams only once on mount:
```tsx
const [role, setRole] = useState(searchParams.get('role') || 'all')
```

When URL changes via `router.push()`, the component re-renders but useState doesn't re-initialize, causing stale values.

## Files to Modify

1. **app/(admin)/dashboard/boards/users/components/user-search.tsx**
   - Add useEffect to sync state with URL params
   - Fix state synchronization issue

## Implementation Plan

### Step 1: Fix State Synchronization in UserSearch
- Add useEffect that watches searchParams and updates state when they change
- Ensure Select components always reflect current URL params

### Step 2: Verification
- Test role filter works correctly
- Test search + role filter combination
- Verify UI state syncs with URL

## Changes Required

**File: app/(admin)/dashboard/boards/users/components/user-search.tsx**

Add useEffect to sync state:
```tsx
// Sync state with URL params when they change
useEffect(() => {
  setSearch(searchParams.get('search') || '')
  setRole(searchParams.get('role') || 'all')
  setStatus(searchParams.get('status') || 'all')
}, [searchParams])
```

## Verification Steps

1. Navigate to admin users page
2. Select "Admin" from role dropdown and click Filter
3. Verify URL shows `?role=admin`
4. Verify only admin users are shown (1 user based on DB)
5. Verify dropdown still shows "Admin" (not "All Roles")
6. Clear filters and verify dropdown resets to "All Roles"

## Test Cases

- [ ] Role filter by itself works
- [ ] Search + role filter works together
- [ ] UI state matches URL after filtering
- [ ] Clear filters resets everything
- [ ] Browser back/forward syncs UI state
