# Systematic Debugging Plan: Fix i18n Routing and Default Language

## Problem Description
- **Default (`/`)**: Should be Indonesian (`id`). Currently behaves inconsistently.
- **English (`/en`)**: Should be English (`en`). Currently redirects back to `/`.
- **Expected**:
    - `/` -> Strict Indonesian.
    - `/en` -> Strict English (Rewrite to `/` content).
    - No auto-redirect from `/en` to `/`.

## Phase 1: Exploration (Complete)
- [x] Locate middleware configuration (`middleware.ts`).
- [x] Identify i18n library (`next-intl`) and configuration.
- [x] Analyze locale detection and redirection logic.
    - `middleware.ts` detects locale but doesn't rewrite.
    - `app/[username]/page.tsx` catches `/en` and redirects to `/` setting a cookie.

## Phase 2: Diagnosis (Complete)
- **Cause of `/en` redirect**: `app/[username]/page.tsx` explicitly redirects `LOCALE_CODES` to `/`.
- **Cause of `/` defaulting to English**: Middleware prioritizes Cookie/Header over Default. User wants strict `/` = ID.

## Phase 3: Solution Design
- [ ] **Step 1: Disable Redirect in Component**
    - Modify `app/[username]/page.tsx` to remove/disable the `useEffect` that redirects `/en`.
- [ ] **Step 2: Update Middleware**
    - Implement Strict Routing for Root Paths:
        - If path is `/`, force locale `id`.
        - If path is `/en`, force locale `en` and **REWRITE** to `/`.
    - For other paths, keep existing detection (URL -> Cookie -> Header).
    - Set `x-next-intl-locale` header for server components.
    - Set `NEXT_LOCALE` cookie for client-side persistence (optional, but good for consistency).

## Phase 4: Execution
- [ ] Edit `app/[username]/page.tsx`.
- [ ] Edit `middleware.ts`.

## Phase 5: Verification
- [ ] Manual verification (since I cannot browse).
- [ ] Run build/lint to ensure no syntax errors.
