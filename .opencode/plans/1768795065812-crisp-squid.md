# Plan: Fix /en Route Detection as English Landing Page

## Problem
`/en` is being caught by `app/[username]/page.tsx` and treated as a user profile lookup, causing "User Not Found" error instead of showing English landing page.

## Solution
Add locale detection in `app/[username]/page.tsx` to intercept locale paths (`en`) and redirect to root `/` with the `NEXT_LOCALE` cookie set to `en`.

## Scope
- Only `/en` root path - not subpaths like `/en/blog`
- Redirect behavior: `/en` â†’ `/` with English cookie

---

## Implementation

### File: `app/[username]/page.tsx`

Add early check in the component before any data fetching:

```tsx
// At the top of ProfilePage component, after getting params
const username = params.username as string

// Check if username is a locale code
const LOCALE_CODES = ['en'] // Add more locales here if needed
if (LOCALE_CODES.includes(username)) {
  // Set locale cookie and redirect to root
  document.cookie = `NEXT_LOCALE=${username}; path=/; max-age=31536000; SameSite=Lax`
  router.replace('/')
  return null // Prevent rendering
}
```

**Note:** Since this is a 'use client' component, we can use `document.cookie` and `router.replace()`.

### Alternative: Add useEffect guard

```tsx
useEffect(() => {
  const LOCALE_CODES = ['en']
  if (LOCALE_CODES.includes(username)) {
    document.cookie = `NEXT_LOCALE=${username}; path=/; max-age=31536000; SameSite=Lax`
    router.replace('/')
  }
}, [username, router])
```

---

## Files to Modify

| File | Change |
|------|--------|
| `app/[username]/page.tsx` | Add locale guard at start of component |

---

## Verification

1. Start dev server: `bun dev`
2. Visit `http://localhost:3000/en`
3. Expected: Redirect to `/` with English content (language switcher shows English selected)
4. Verify cookie: `NEXT_LOCALE=en` in browser DevTools
5. Visit `http://localhost:3000/faiz` (real username) - should still work as profile page
6. Visit `http://localhost:3000/randomuser` - should show "User Not Found"

---

## Future Considerations

- If adding more locales (e.g., `/ja`, `/zh`), add them to `LOCALE_CODES` array
- Consider moving to middleware-based solution if subpath support needed later
