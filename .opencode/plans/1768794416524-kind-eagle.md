# i18n Implementation Plan

**Issue**: [#3 - Add internationalization (i18n)](https://github.com/julianromli/vibedevid/issues/3)  
**Scope**: Landing page only (initial phase)  
**Library**: next-intl  
**Locales**: Indonesian (id) - default, English (en)

---

## Design Decisions

| Decision | Choice |
|----------|--------|
| URL Structure | Prefix routes (`/en/...`, `/` = default ID) |
| Default Locale | Indonesian (`id`) - no redirect |
| Locale Detection | URL â†’ Cookie â†’ Accept-Language â†’ Default |
| Language Switcher | Navbar (dropdown before ThemeToggle) |

---

## Implementation Tasks

### 1. Install & Configure next-intl

```bash
bun add next-intl
```

**Files to create:**

- `i18n/routing.ts` - Locale config (locales, defaultLocale, localePrefix)
- `i18n/request.ts` - getRequestConfig for message loading

**Files to modify:**

- `next.config.ts` - Add next-intl plugin

### 2. Update Middleware

**File**: `middleware.ts`

- Integrate `createMiddleware` from next-intl before Supabase auth
- Locale detection priority: URL â†’ Cookie â†’ Accept-Language â†’ Default (id)
- Set `NEXT_LOCALE` cookie for persistence
- Exclude: `/_next/*`, `/api/*`, `/auth/callback`, static files

### 3. Create Message Files

**Files to create:**

- `messages/id.json` - Indonesian translations
- `messages/en.json` - English translations

**Namespaces:**
- `common` - Shared strings (signIn, signOut, profile, etc.)
- `navbar` - Navigation items
- `hero` - Hero section content
- `toast` - Toast messages

### 4. Restructure App Directory

**Current:**
```
app/
â”œâ”€â”€ page.tsx
â”œâ”€â”€ home-page-client.tsx
â””â”€â”€ layout.tsx
```

**Target:**
```
app/
â”œâ”€â”€ [locale]/
â”‚   â”œâ”€â”€ layout.tsx         # NextIntlClientProvider wrapper
â”‚   â”œâ”€â”€ page.tsx           # Server component (moved)
â”‚   â””â”€â”€ home-page-client.tsx  # Client component (moved)
â””â”€â”€ layout.tsx             # Root layout (minimal)
```

### 5. Update Components

**Files to modify:**

- `components/sections/hero-section.tsx`
  - Import `useTranslations` from next-intl
  - Replace hardcoded Indonesian text with translation keys
  - Keep animated title logic, use translated words

- `components/ui/navbar.tsx`
  - Import `useTranslations` from next-intl
  - Translate nav items, buttons, toasts
  - Add LanguageSwitcher component

**Files to create:**

- `components/ui/language-switcher.tsx`
  - Dropdown with locale options (ðŸ‡®ðŸ‡© ID / ðŸ‡¬ðŸ‡§ EN)
  - On select: set cookie + redirect to new locale path
  - Use existing DropdownMenu component

---

## Critical Files

| File | Purpose |
|------|---------|
| `middleware.ts` | Locale detection + Supabase auth integration |
| `i18n/routing.ts` | Locale configuration |
| `i18n/request.ts` | Message loading |
| `app/[locale]/layout.tsx` | NextIntlClientProvider |
| `messages/id.json` | Indonesian translations |
| `messages/en.json` | English translations |
| `components/ui/language-switcher.tsx` | Language switcher UI |
| `components/ui/navbar.tsx` | Add language switcher |
| `components/sections/hero-section.tsx` | Translate hero content |

---

## Translation Keys (Scope)

```json
{
  "common": {
    "signIn": "...",
    "signOut": "...",
    "profile": "...",
    "myPosts": "...",
    "write": "..."
  },
  "navbar": {
    "projects": "...",
    "blog": "...",
    "showcase": "...",
    "features": "...",
    "reviews": "...",
    "faq": "...",
    "writePost": "..."
  },
  "hero": {
    "announcement": "...",
    "readLatest": "...",
    "title1": "...",
    "title2": "...",
    "subtitle": "...",
    "joinCommunity": "...",
    "ourShowcase": "..."
  },
  "toast": {
    "signOutSuccess": "...",
    "signOutError": "...",
    "generalError": "..."
  }
}
```

---

## Verification

### Build & Type Check
```bash
bun tsc --noEmit
bun build
```

### Manual Testing
```bash
bun dev
```

1. Visit `http://localhost:3000` â†’ Should show Indonesian content
2. Visit `http://localhost:3000/en` â†’ Should show English content
3. Click language switcher â†’ Should redirect and persist choice
4. Refresh page â†’ Should remember locale preference
5. Test Supabase auth flow â†’ Should work in both locales
6. Check no raw translation keys visible in UI

### E2E Test (Optional)
- Add test in `tests/` for locale switching if time permits

---

## Future Expansion

After landing page is stable, expand to:
1. Blog pages (`/blog`, `/blog/[slug]`)
2. Project pages (`/project/list`, `/project/[slug]`)
3. Auth pages (`/user/auth`)
4. Other public pages (terms, calendar)
