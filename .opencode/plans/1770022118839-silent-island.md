# Admin Dashboard Integration Analysis - UPDATED

## User Requirements (Updated)

Based on user clarification:

| Requirement | Decision |
|-------------|----------|
| **Projects** | Auto-published (no approval workflow) |
| **Comments** | Auto-published (moderation only for reported comments) |
| **Dashboard Access** | Only admin (role=0) - no moderator access |
| **Analytics Priority** | Basic stats (total users, projects, posts, views) |

---

## Current State

### Existing Admin Dashboard Features

The application has a **dual dashboard system**:

1. **Admin Dashboard** at `/dashboard`
   - Route: `app/(admin)/dashboard/`
   - Has Overview, Analytics tabs (mostly static/placeholder data)
   - **Events Approval** - Fully implemented with approve/reject workflow
   - Collapsible sidebar navigation

2. **User Dashboard** at `/dashboard/posts`
   - Route: `app/dashboard/posts/`
   - Blog post management for individual users
   - CRUD for user's own posts only

---

## Database Schema (Supabase)

### Tables Requiring Admin Management

| Table | Purpose | Admin Actions Needed |
|-------|---------|---------------------|
| `users` | User profiles with roles (0=admin, 1=moderator, 2=user) | List, search, edit roles, suspend |
| `projects` | User-submitted projects | Edit, delete, feature (no approval needed) |
| `posts` | Blog posts | Edit, delete, feature, manage status |
| `events` | Community events | ✅ **Already implemented** - approve/reject |
| `comments` | Unified comments (projects + blog) | Delete, view reports (auto-published) |
| `blog_reports` | Reported comments | Review reports, take action |
| `post_tags` | Blog post tags/categories | CRUD management |
| `vibe_videos` | Homepage YouTube videos | CRUD management |
| `likes` | Project likes | Analytics only |
| `views` | Page views tracking | Analytics only |

---

## Features Missing from Admin Dashboard

### 1. **Projects Management** (High Priority)
**Location:** `lib/actions.ts`

**Current Implementation:**
- `submitProject()`, `editProject()`, `deleteProject()` - User actions
- `fetchProjectsWithSorting()` - Public listing
- `incrementProjectViews()`, `toggleLike()` - Engagement

**Admin Features Needed:**
- [ ] List all projects with filtering (status, category, date)
- [ ] ~~Moderation workflow~~ (NOT NEEDED - auto-publish)
- [ ] Edit/delete any project
- [ ] Feature projects (pin to top)
- [ ] View project analytics (views, likes, comments count)

**Files To Create:**
- [ ] `app/(admin)/dashboard/boards/projects/page.tsx`
- [ ] `app/(admin)/dashboard/boards/projects/components/projects-table.tsx`

---

### 2. **Blog Posts Management** (High Priority)
**Location:** `lib/actions/blog.ts`

**Current Implementation:**
- `createBlogPost()`, `updateBlogPost()`, `deleteBlogPost()` - User actions
- `getAuthorPosts()` - User's own posts
- `getTags()`, `syncPostTags()` - Tag management

**Admin Features Needed:**
- [ ] List all blog posts across users
- [ ] Edit/delete any post
- [ ] Feature posts (pin to homepage)
- [ ] Manage post tags (create/edit/delete tags)
- [ ] View post analytics (views, read time)

**Files To Create:**
- [ ] `app/(admin)/dashboard/boards/blog/page.tsx`
- [ ] `app/(admin)/dashboard/boards/blog/components/posts-table.tsx`
- [ ] `app/(admin)/dashboard/boards/blog/components/tags-manager.tsx`

---

### 3. **Users Management** (High Priority)
**Location:** `lib/actions/user.ts`, `types/homepage.ts`

**Current Implementation:**
- `getCurrentUser()` - Get current user
- `users` table with `role` column (0=admin, 1=moderator, 2=user)

**Admin Features Needed:**
- [ ] List all users with search/filter
- [ ] View user profiles and activity
- [ ] Manage user roles (promote/demote)
- [ ] Suspend/ban users
- [ ] View user statistics (projects, posts, comments)

**Files To Create:**
- [ ] `app/(admin)/dashboard/boards/users/page.tsx`
- [ ] `app/(admin)/dashboard/boards/users/components/users-table.tsx`

---

### 4. **Comments Moderation** (Medium Priority)
**Location:** `lib/actions/comments.ts`, `types/comments.ts`

**Current Implementation:**
- `createComment()`, `getComments()` - Standard operations
- `reportComment()` - Report for moderation
- `blog_reports` table stores reports

**Admin Features Needed:**
- [ ] ~~Comments moderation queue~~ (NOT NEEDED - auto-publish)
- [ ] View reported comments
- [ ] Delete comments
- [ ] Handle reports (dismiss/take action)

**Files To Create:**
- [ ] `app/(admin)/dashboard/boards/comments/page.tsx`
- [ ] `app/(admin)/dashboard/boards/comments/components/reports-table.tsx`

---

### 5. **Real Analytics Dashboard** (Medium Priority)
**Location:** Various tables

**Current Implementation:**
- `app/(admin)/dashboard/boards/overview/` - Static placeholder data
- `views`, `likes` tables track engagement

**Admin Features Needed:**
- [ ] Real platform statistics (not static)
- [ ] Total users, projects, posts, comments (BASIC STATS PRIORITY)
- [ ] Most viewed projects/posts
- [ ] User engagement metrics (optional)
- [ ] Traffic sources (if tracked) (optional)
- [ ] Charts/visualizations with real data

**Files To Create/Modify:**
- [ ] `app/(admin)/dashboard/boards/overview/index.tsx` - Real data
- [ ] `lib/actions/analytics.ts` - Analytics actions

---

### 6. **Vibe Videos Management** (Low Priority) ⏸️
**Location:** `scripts/migrations/013_vibe_videos.sql`

**Current Implementation:**
- `vibe_videos` table for homepage YouTube videos
- No management UI exists

**Admin Features Needed:**
- [ ] CRUD for YouTube videos
- [ ] Set display order
- [ ] Update video metadata

**Status:** Deferred to future phase

---

## Priority Order (UPDATED)

### Phase 1: Core Content Management
1. [ ] **Projects Management** - List, edit, delete, feature
2. [ ] **Blog Posts Management** - List, edit, delete, manage tags

### Phase 2: User & Engagement
3. [ ] **Users Management** - List, roles, suspend
4. [ ] **Comments Moderation** - Reports management only

### Phase 3: Analytics
5. [ ] **Real Analytics** - Basic stats dashboard

### Phase 4: Future ⏸️
6. ⏸️ **Vibe Videos** - Nice to have, deferred

---

## Technical Notes

### Access Control

**ONLY Admin (role=0)** can access dashboard:

```typescript
const user = await getCurrentUser()
if (!user || user.role !== 0) {
  redirect('/')
}
```

**NO moderator access** - role=1 and role=2 cannot access admin dashboard.

### Content Publishing

- **Projects**: Auto-published immediately (no approval workflow)
- **Comments**: Auto-published immediately (moderation only for reported content)
- **Events**: Still require approval (existing workflow maintained)

### Existing Patterns to Follow

**Server Actions Pattern:**
```typescript
// lib/actions/{feature}.ts
export async function getPendingEvents() { ... }
export async function approveEvent(id: string) { ... }
export async function rejectEvent(id: string) { ... }
```

**Admin Page Pattern:**
```typescript
// app/(admin)/dashboard/boards/{feature}/page.tsx
export default async function FeaturePage() {
  const user = await getCurrentUser()
  if (!user || user.role !== 0) redirect('/')
  
  const data = await getFeatureData()
  return <FeatureBoard data={data} />
}
```

**Table Component Pattern:**
- Use TanStack Table (already used in events-approval)
- Components in `app/(admin)/dashboard/boards/{feature}/components/`

---

## Implementation Status

| Feature | Status | Files |
|---------|--------|-------|
| Events Approval | ✅ Done | `dashboard/boards/events-approval/` |
| Projects Management | ⏳ Pending | `dashboard/boards/projects/` |
| Blog Posts Management | ⏳ Pending | `dashboard/boards/blog/` |
| Users Management | ⏳ Pending | `dashboard/boards/users/` |
| Comments Moderation | ⏳ Pending | `dashboard/boards/comments/` |
| Analytics Dashboard | ⏳ Pending | `dashboard/boards/overview/` |
| Vibe Videos | ⏸️ Deferred | - |

---

## Sidebar Navigation

Navigation menu di sidebar perlu diupdate untuk menampilkan menu baru:

```typescript
// components/admin-panel/data/sidebar-data.tsx
{
  title: "Content",
  items: [
    { title: "Projects", url: "/dashboard/boards/projects" },
    { title: "Blog Posts", url: "/dashboard/boards/blog" },
    { title: "Events", url: "/dashboard/boards/events-approval" },
  ]
},
{
  title: "Community",
  items: [
    { title: "Users", url: "/dashboard/boards/users" },
    { title: "Comments", url: "/dashboard/boards/comments" },
  ]
}
```
